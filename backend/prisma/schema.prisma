generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Company {
  id                 Int              @id @default(autoincrement())
  name               String
  contactEmail       String
  contactPhone       String?
  subscriptionPlan   String
  subscriptionEndsAt DateTime?
  createdAt          DateTime         @default(now())
  serviceRequests    ServiceRequest[]
  users              User[]           @relation("CompanyUsers")

  @@map("companies")
}

model User {
  id                     Int              @id @default(autoincrement())
  companyId              Int
  firstName              String
  lastName               String
  email                  String           @unique
  passwordHash           String
  role                   UserRole
  isActive               Boolean          @default(true)
  createdAt              DateTime         @default(now())
  createdServiceRequests ServiceRequest[] @relation("CreatedServiceRequests")
  company                Company          @relation("CompanyUsers", fields: [companyId], references: [id])

  @@map("users")
}

model ServiceRequest {
  id          Int           @id @default(autoincrement())
  title       String
  description String
  status      RequestStatus @default(PENDING)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  dueDate     DateTime?
  companyId   Int
  createdById Int
  urgency     UrgencyLevel  @default(MEDIUM)
  company     Company       @relation(fields: [companyId], references: [id])
  createdBy   User          @relation("CreatedServiceRequests", fields: [createdById], references: [id])
}

enum UserRole {
  Admin
  Manager
  Employee
}

enum RequestStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum UrgencyLevel {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}
